###     SCRIPT: RECODING OF INFANT FFQ VARIABLE HEADERS FOR WUR - 9 12MND CODEBOOK
###     AUTHOR(S): SIOBHAN BRUSHETT 
###     DESCRIPTION: RECODE INFANT FFQ VARIABLE HEADERS FOR DOWNSTREAM WUR PROCESSING
###     PROJECT: NEXT-INFANT-FFQ
###     NOTE(S): 


##Contents of this file

## 0. LOAD DATA
## 1. M9 FFQs RECODING
## 2. M12 FFQs RECODING
## 3. CLEAN AND MERGE DATASETS

library(tidyverse)

   ## =============== 0. LOAD DATA   ================ ##

m9 <-  read.csv("qs_data_M9_Baby_2021-07-23_15_20_21.csv", header=T, as.is=T, sep=",")
dim(m9)
#293 415


m12 <-  read.csv("qs_data_M12_Baby_2021-07-23_15_21_23.csv", header=T, as.is=T, sep=",")
dim(m12)
#231 754

   ## =============== 1. M9 FFQs RECODING ================ ##

x = c("CHALLERGY6",
      "CHALLERGY6A",
      "CHALLERGY6B",
      "CHALLERGY6C",
      "CHALLERGY6D",
      "CHALLERGY6E",
      "CHALLERGY6F",
      "CHALLERGY6FTXT",
      "CHFOOD8",
      "CHFOOD8A",
      "CHFOOD8B",
      "CHFOOD8C",
      "CHFOOD8CTXT",
      "CHFOOD9A",
      "CHFOOD9B",
      "CHFOOD10A",
      "CHFOOD10B",
      "CHFOOD10C",
      "CHFOOD10D20",
      "CHFOOD10D21",
      "CHFOOD10D22",
      "CHFOOD10D23",
      "CHFOOD10D24",
      "CHFOOD10D25",
      "CHFOOD10D26",
      "CHFOOD10D27",
      "CHFOOD10D28",
      "CHFOOD10D7",
      "CHFOOD10D29",
      "CHFOOD10D30",
      "CHFOOD10D9",
      "CHFOOD10D31",
      "CHFOOD10D32",
      "CHFOOD10D33",
      "CHFOOD10D34",
      "CHFOOD10D35",
      "CHFOOD10D13",
      "CHFOOD10D36",
      "CHFOOD10D37",
      "CHFOOD10D38",
      "CHFOOD10D39",
      "CHFOOD10D17",
      "CHFOOD10D40",
      "CHFOOD10D19",
      "CHFOOD10D19TXT",
      "CHFOOD11A",
      "CHFOOD11B",
      "CHFOOD12A",
      "CHFOOD12B",
      "CHFOOD13A",
      "CHFOOD13B",
      "CHFOOD13C1",
      "CHFOOD13C2",
      "CHFOOD13C3",
      "CHFOOD13C4",
      "CHFOOD14A",
      "CHFOOD14B1",
      "CHFOOD14B2",
      "CHFOOD14B3",
      "CHFOOD14B4",
      "CHFOOD14B5",
      "CHFOOD14B6",
      "CHFOOD14B7",
      "CHFOOD14B8",
      "CHFOOD14B9",
      "CHFOOD14B9TXT",
      "CHFOOD14C",
      "CHFOOD15A",
      "CHFOOD15B",
      "CHFOOD15C",
      "CHFOOD16A",
      "CHFOOD16B",
      "CHFOOD17A",
      "CHFOOD17B",
      "CHFOOD18A",
      "CHFOOD18B",
      "CHFOOD19A",
      "CHFOOD19B",
      "CHFOOD19C1",
      "CHFOOD19C2",
      "CHFOOD36A",
      "CHFOOD36B",
      "CHFOOD37A",
      "CHFOOD37B",
      "CHFOOD38A",
      "CHFOOD38B",
      "CHFOOD39A",
      "CHFOOD39B",
      "CHFOOD40A",
      "CHFOOD40B",
      "CHFOOD41A",
      "CHFOOD41B",
      "CHFOOD20A",
      "CHFOOD20B",
      "CHFOOD42A",
      "CHFOOD42B",
      "CHFOOD21A",
      "CHFOOD21B",
      "CHFOOD22A",
      "CHFOOD22B",
      "CHFOOD23A",
      "CHFOOD23B",
      "CHFOOD24A",
      "CHFOOD24B",
      "CHFOOD43A",
      "CHFOOD43B",
      "CHFOOD25A1",
      "CHFOOD25B",
      "CHFOOD25C1",
      "CHFOOD25C2",
      "CHFOOD25C3",
      "CHFOOD25C4A",
      "CHFOOD26A",
      "CHFOOD26B",
      "CHFOOD27A",
      "CHFOOD27B",
      "CHFOOD28A",
      "CHFOOD28B",
      "CHFOOD29A",
      "CHFOOD29B",
      "CHFOOD29C",
      "CHFOOD29D",
      "CHFOOD29E",
      "CHFOOD29F",
      "CHFOOD29G",
      "CHFOOD29H",
      "CHFOOD29I",
      "CHFOOD29J",
      "CHFOOD29K",
      "CHFOOD29L",
      "CHFOOD29M",
      "CHFOOD29N",
      "CHFOOD29O",
      "CHFOOD29P",
      "CHFOOD29PTXT",
      "CHFOOD30A",
      "CHFOOD30B",
      "CHFOOD30C1",
      "CHFOOD30C2",
      "CHFOOD30C3",
      "CHFOOD30C4",
      "CHFOOD44A",
      "CHFOOD44B",
      "CHFOOD45A",
      "CHFOOD45B",
      "CHFOOD46A",
      "CHFOOD46B",
      "CHFOOD47A",
      "CHFOOD47B",
      "CHFOOD48A",
      "CHFOOD48B",
      "CHFOOD49A",
      "CHFOOD49B",
      "CHFOOD50A",
      "CHFOOD50B",
      "CHFOOD51A",
      "CHFOOD51B",
      "CHFOOD31A",
      "CHFOOD31B",
      "CHFOOD32A",
      "CHFOOD32B",
      "CHFOOD33A",
      "CHFOOD33B",
      "CHFOOD34TXT",
      "CHFOOD35A",
      "CHFOOD35C",
      "XCHFOOD35D",
      "CHFOOD52A",
      "CHFOOD52B",
      "XCHFOOD52C") %in% colnames(m9)

unique(x)

m9_wur <- m9 [ , c("NEXT_NR", 
                   "CHALLERGY6",
                   "CHALLERGY6A",
                   "CHALLERGY6B",
                   "CHALLERGY6C",
                   "CHALLERGY6D",
                   "CHALLERGY6E",
                   "CHALLERGY6F",
                   "CHALLERGY6FTXT",
                   "CHFOOD8",
                   "CHFOOD8A",
                   "CHFOOD8B",
                   "CHFOOD8C",
                   "CHFOOD8CTXT",
                   "CHFOOD9A",
                   "CHFOOD9B",
                   "CHFOOD10A",
                   "CHFOOD10B",
                   "CHFOOD10C",
                   "CHFOOD10D20",
                   "CHFOOD10D21",
                   "CHFOOD10D22",
                   "CHFOOD10D23",
                   "CHFOOD10D24",
                   "CHFOOD10D25",
                   "CHFOOD10D26",
                   "CHFOOD10D27",
                   "CHFOOD10D28",
                   "CHFOOD10D7",
                   "CHFOOD10D29",
                   "CHFOOD10D30",
                   "CHFOOD10D9",
                   "CHFOOD10D31",
                   "CHFOOD10D32",
                   "CHFOOD10D33",
                   "CHFOOD10D34",
                   "CHFOOD10D35",
                   "CHFOOD10D13",
                   "CHFOOD10D36",
                   "CHFOOD10D37",
                   "CHFOOD10D38",
                   "CHFOOD10D39",
                   "CHFOOD10D17",
                   "CHFOOD10D40",
                   "CHFOOD10D19",
                   "CHFOOD10D19TXT",
                   "CHFOOD11A",
                   "CHFOOD11B",
                   "CHFOOD12A",
                   "CHFOOD12B",
                   "CHFOOD13A",
                   "CHFOOD13B",
                   "CHFOOD13C1",
                   "CHFOOD13C2",
                   "CHFOOD13C3",
                   "CHFOOD13C4",
                   "CHFOOD14A",
                   "CHFOOD14B1",
                   "CHFOOD14B2",
                   "CHFOOD14B3",
                   "CHFOOD14B4",
                   "CHFOOD14B5",
                   "CHFOOD14B6",
                   "CHFOOD14B7",
                   "CHFOOD14B8",
                   "CHFOOD14B9",
                   "CHFOOD14B9TXT",
                   "CHFOOD14C",
                   "CHFOOD15A",
                   "CHFOOD15B",
                   "CHFOOD15C",
                   "CHFOOD16A",
                   "CHFOOD16B",
                   "CHFOOD17A",
                   "CHFOOD17B",
                   "CHFOOD18A",
                   "CHFOOD18B",
                   "CHFOOD19A",
                   "CHFOOD19B",
                   "CHFOOD19C1",
                   "CHFOOD19C2",
                   "CHFOOD36A",
                   "CHFOOD36B",
                   "CHFOOD37A",
                   "CHFOOD37B",
                   "CHFOOD38A",
                   "CHFOOD38B",
                   "CHFOOD39A",
                   "CHFOOD39B",
                   "CHFOOD40A",
                   "CHFOOD40B",
                   "CHFOOD41A",
                   "CHFOOD41B",
                   "CHFOOD20A",
                   "CHFOOD20B",
                   "CHFOOD42A",
                   "CHFOOD42B",
                   "CHFOOD21A",
                   "CHFOOD21B",
                   "CHFOOD22A",
                   "CHFOOD22B",
                   "CHFOOD23A",
                   "CHFOOD23B",
                   "CHFOOD24A",
                   "CHFOOD24B",
                   "CHFOOD43A",
                   "CHFOOD43B",
                   "CHFOOD25A1",
                   "CHFOOD25B",
                   "CHFOOD25C1",
                   "CHFOOD25C2",
                   "CHFOOD25C3",
                   "CHFOOD25C4A",
                   "CHFOOD26A",
                   "CHFOOD26B",
                   "CHFOOD27A",
                   "CHFOOD27B",
                   "CHFOOD28A",
                   "CHFOOD28B",
                   "CHFOOD29A",
                   "CHFOOD29B",
                   "CHFOOD29C",
                   "CHFOOD29D",
                   "CHFOOD29E",
                   "CHFOOD29F",
                   "CHFOOD29G",
                   "CHFOOD29H",
                   "CHFOOD29I",
                   "CHFOOD29J",
                   "CHFOOD29K",
                   "CHFOOD29L",
                   "CHFOOD29M",
                   "CHFOOD29N",
                   "CHFOOD29O",
                   "CHFOOD29P",
                   "CHFOOD29PTXT",
                   "CHFOOD30A",
                   "CHFOOD30B",
                   "CHFOOD30C1",
                   "CHFOOD30C2",
                   "CHFOOD30C3",
                   "CHFOOD30C4",
                   "CHFOOD44A",
                   "CHFOOD44B",
                   "CHFOOD45A",
                   "CHFOOD45B",
                   "CHFOOD46A",
                   "CHFOOD46B",
                   "CHFOOD47A",
                   "CHFOOD47B",
                   "CHFOOD48A",
                   "CHFOOD48B",
                   "CHFOOD49A",
                   "CHFOOD49B",
                   "CHFOOD50A",
                   "CHFOOD50B",
                   "CHFOOD51A",
                   "CHFOOD51B",
                   "CHFOOD31A",
                   "CHFOOD31B",
                   "CHFOOD32A",
                   "CHFOOD32B",
                   "CHFOOD33A",
                   "CHFOOD33B",
                   "CHFOOD34TXT",
                   "CHFOOD35A",
                   "CHFOOD35C",
                   "XCHFOOD35D",
                   "CHFOOD52A",
                   "CHFOOD52B",
                   "XCHFOOD52C")] 

dim(m9_wur)
# 293 171


m9_wur <- m9_wur %>% rename("patrI_1_M9"="CHALLERGY6",
                            "patrI_2_M9"="CHALLERGY6A",
                            "patrI_3_M9"="CHALLERGY6B",
                            "patrI_4_M9"="CHALLERGY6C",
                            "patrI_5_M9"="CHALLERGY6D",
                            "patrI_6_M9"="CHALLERGY6E",
                            "patrI_7_M9"="CHALLERGY6F",
                            "patrI_7anders_M9"="CHALLERGY6FTXT",
                            "patrII_1_M9"="CHFOOD8",
                            "patrII_2_M9"="CHFOOD8A",
                            "patrII_3_M9"="CHFOOD8B",
                            "patrII_4_M9"="CHFOOD8C",
                            "patrII_4anders_M9"="CHFOOD8CTXT",
                            "v01a_M9"="CHFOOD9A",
                            "v01b_M9"="CHFOOD9B",
                            "v02a_M9"="CHFOOD10A",
                            "v02b_M9"="CHFOOD10B",
                            "v02c_M9"="CHFOOD10C",
                            "v02d1_M9"="CHFOOD10D20",
                            "v02d2_M9"="CHFOOD10D21",
                            "v02d3_M9"="CHFOOD10D22",
                            "v02d4_M9"="CHFOOD10D23",
                            "v02d5_M9"="CHFOOD10D24",
                            "v02d6_M9"="CHFOOD10D25",
                            "v02d7_M9"="CHFOOD10D26",
                            "v02d8_M9"="CHFOOD10D27",
                            "v02d9_M9"="CHFOOD10D28",
                            "v02d10_M9"="CHFOOD10D7",
                            "v02d11_M9"="CHFOOD10D29",
                            "v02d12_M9"="CHFOOD10D30",
                            "v02d13_M9"="CHFOOD10D9",
                            "v02d14_M9"="CHFOOD10D31",
                            "v02d15_M9"="CHFOOD10D32",
                            "v02d16_M9"="CHFOOD10D33",
                            "v02d17_M9"="CHFOOD10D34",
                            "v02d18_M9"="CHFOOD10D35",
                            "v02d19_M9"="CHFOOD10D13",
                            "v02d20_M9"="CHFOOD10D36",
                            "v02d21_M9"="CHFOOD10D37",
                            "v02d22_M9"="CHFOOD10D38",
                            "v02d23_M9"="CHFOOD10D39",
                            "v02d24_M9"="CHFOOD10D17",
                            "v02d25_M9"="CHFOOD10D40",
                            "v02d26_M9"="CHFOOD10D19",
                            "v02d26_anders_M9"="CHFOOD10D19TXT",
                            "v03a_M9"="CHFOOD11A",
                            "v03b_M9"="CHFOOD11B",
                            "v04a_M9"="CHFOOD12A",
                            "v04b_M9"="CHFOOD12B",
                            "v05a_M9"="CHFOOD13A",
                            "v05b_M9"="CHFOOD13B",
                            "v05c1_M9"="CHFOOD13C1",
                            "v05c2_M9"="CHFOOD13C2",
                            "v05c3_M9"="CHFOOD13C3",
                            "v05c4_M9"="CHFOOD13C4",
                            "v06a_M9"="CHFOOD14A",
                            "v06b1_M9"="CHFOOD14B1",
                            "v06b2_M9"="CHFOOD14B2",
                            "v06b3_M9"="CHFOOD14B3",
                            "v06b4_M9"="CHFOOD14B4",
                            "v06b5_M9"="CHFOOD14B5",
                            "v06b6_M9"="CHFOOD14B6",
                            "v06b7_M9"="CHFOOD14B7",
                            "v06b8_M9"="CHFOOD14B8",
                            "v06b9_M9"="CHFOOD14B9",
                            "v06b9_anders_M9"="CHFOOD14B9TXT",
                            "v06c_M9"="CHFOOD14C",
                            "v07a_M9"="CHFOOD15A",
                            "v07b_M9"="CHFOOD15B",
                            "v07c_M9"="CHFOOD15C",
                            "v08a_M9"="CHFOOD16A",
                            "v08b_M9"="CHFOOD16B",
                            "v09a_M9"="CHFOOD17A",
                            "v09b_M9"="CHFOOD17B",
                            "v10a_M9"="CHFOOD18A",
                            "v10b_M9"="CHFOOD18B",
                            "v11a_M9"="CHFOOD19A",
                            "v11b_M9"="CHFOOD19B",
                            "v11c1_M9"="CHFOOD19C1",
                            "v11c2_M9"="CHFOOD19C2",
                            "v12a_M9"="CHFOOD36A",
                            "v12b_M9"="CHFOOD36B",
                            "v13a_M9"="CHFOOD37A",
                            "v13b_M9"="CHFOOD37B",
                            "v14a_M9"="CHFOOD38A",
                            "v14b_M9"="CHFOOD38B",
                            "v15a_M9"="CHFOOD39A",
                            "v15b_M9"="CHFOOD39B",
                            "v16a_M9"="CHFOOD40A",
                            "v16b_M9"="CHFOOD40B",
                            "v17a_M9"="CHFOOD41A",
                            "v17b_M9"="CHFOOD41B",
                            "v18a_M9"="CHFOOD20A",
                            "v18b_M9"="CHFOOD20B",
                            "v19a_M9"="CHFOOD42A",
                            "v19b_M9"="CHFOOD42B",
                            "v20a_M9"="CHFOOD21A",
                            "v20b_M9"="CHFOOD21B",
                            "v21a_M9"="CHFOOD22A",
                            "v21b_M9"="CHFOOD22B",
                            "v22a_M9"="CHFOOD23A",
                            "v22b_M9"="CHFOOD23B",
                            "v23a_M9"="CHFOOD24A",
                            "v23b_M9"="CHFOOD24B",
                            "v24a_M9"="CHFOOD43A",
                            "v24b_M9"="CHFOOD43B",
                            "v25a_M9"="CHFOOD25A1",
                            "v25b_M9"="CHFOOD25B",
                            "v25c1_M9"="CHFOOD25C1",
                            "v25c2_M9"="CHFOOD25C2",
                            "v25c3_M9"="CHFOOD25C3",
                            "v25c4_M9"="CHFOOD25C4A",
                            "v26a_M9"="CHFOOD26A",
                            "v26b_M9"="CHFOOD26B",
                            "v27a_M9"="CHFOOD27A",
                            "v27b_M9"="CHFOOD27B",
                            "v28a_M9"="CHFOOD28A",
                            "v28b_M9"="CHFOOD28B",
                            "v29a1_M9"="CHFOOD29A",
                            "v29a2_M9"="CHFOOD29B",
                            "v29a3_M9"="CHFOOD29C",
                            "v29a4_M9"="CHFOOD29D",
                            "v29a5_M9"="CHFOOD29E",
                            "v29a6_M9"="CHFOOD29F",
                            "v29a7_M9"="CHFOOD29G",
                            "v29a8_M9"="CHFOOD29H",
                            "v29a9_M9"="CHFOOD29I",
                            "v29a10_M9"="CHFOOD29J",
                            "v29a11_M9"="CHFOOD29K",
                            "v29a12_M9"="CHFOOD29L",
                            "v29a13_M9"="CHFOOD29M",
                            "v29a14_M9"="CHFOOD29N",
                            "v29a15_M9"="CHFOOD29O",
                            "v29a16_M9"="CHFOOD29P",
                            "v29a16_anders_M9"="CHFOOD29PTXT",
                            "v30a_M9"="CHFOOD30A",
                            "v30b_M9"="CHFOOD30B",
                            "v30c1_M9"="CHFOOD30C1",
                            "v30c2_M9"="CHFOOD30C2",
                            "v30c3_M9"="CHFOOD30C3",
                            "v30c4_M9"="CHFOOD30C4",
                            "v31a_M9"="CHFOOD44A",
                            "v31b_M9"="CHFOOD44B",
                            "v32a_M9"="CHFOOD45A",
                            "v32b_M9"="CHFOOD45B",
                            "v33a_M9"="CHFOOD46A",
                            "v33b_M9"="CHFOOD46B",
                            "v34a_M9"="CHFOOD47A",
                            "v34b_M9"="CHFOOD47B",
                            "v35a_M9"="CHFOOD48A",
                            "v35b_M9"="CHFOOD48B",
                            "v36a_M9"="CHFOOD49A",
                            "v36b_M9"="CHFOOD49B",
                            "v37a_M9"="CHFOOD50A",
                            "v37b_M9"="CHFOOD50B",
                            "v38a_M9"="CHFOOD51A",
                            "v38b_M9"="CHFOOD51B",
                            "v39a_M9"="CHFOOD31A",
                            "v39b_M9"="CHFOOD31B",
                            "v40a_M9"="CHFOOD32A",
                            "v40b_M9"="CHFOOD32B",
                            "v41a_M9"="CHFOOD33A",
                            "v41b_M9"="CHFOOD33B",
                            "v42_M9"="CHFOOD34TXT",
                            "v43a_M9"="CHFOOD35A",
                            "v43b_M9"="CHFOOD35C",
                            "v43c_M9"="XCHFOOD35D",
                            "v44a_M9"="CHFOOD52A",
                            "v44b_M9"="CHFOOD52B",
                            "v44c_M9"="XCHFOOD52C")
colnames(m9_wur)
str(m9_wur)

write.csv(m9_wur, "/groups/umcg-llnext/tmp01/umcg-snbrushett/processed/FFQs_recoded_WUR/FFQs_by_time_point/20.08.2021_M9_WUR.csv")

   ## =============== 2. M12 FFQs RECODING ================ ##

x = c("CHALLERGY6",
      "CHALLERGY6A",
      "CHALLERGY6B",
      "CHALLERGY6C",
      "CHALLERGY6D",
      "CHALLERGY6E",
      "CHALLERGY6F",
      "CHALLERGY6FTXT",
      "CHFOOD8",
      "CHFOOD8A",
      "CHFOOD8B",
      "CHFOOD8C",
      "CHFOOD8CTXT",
      "CHFOOD9A",
      "CHFOOD9B",
      "CHFOOD10A",
      "CHFOOD10B",
      "CHFOOD10C",
      "CHFOOD10D20",
      "CHFOOD10D21",
      "CHFOOD10D22",
      "CHFOOD10D23",
      "CHFOOD10D24",
      "CHFOOD10D25",
      "CHFOOD10D26",
      "CHFOOD10D27",
      "CHFOOD10D28",
      "CHFOOD10D7",
      "CHFOOD10D29",
      "CHFOOD10D30",
      "CHFOOD10D9",
      "CHFOOD10D31",
      "CHFOOD10D32",
      "CHFOOD10D33",
      "CHFOOD10D34",
      "CHFOOD10D35",
      "CHFOOD10D13",
      "CHFOOD10D36",
      "CHFOOD10D37",
      "CHFOOD10D38",
      "CHFOOD10D39",
      "CHFOOD10D17",
      "CHFOOD10D40",
      "CHFOOD10D19",
      "CHFOOD10D19TXT",
      "CHFOOD11A",
      "CHFOOD11B",
      "CHFOOD12A",
      "CHFOOD12B",
      "CHFOOD13A",
      "CHFOOD13B",
      "CHFOOD13C1",
      "CHFOOD13C2",
      "CHFOOD13C3",
      "CHFOOD13C4",
      "CHFOOD14A",
      "CHFOOD14B1",
      "CHFOOD14B2",
      "CHFOOD14B3",
      "CHFOOD14B4",
      "CHFOOD14B5",
      "CHFOOD14B6",
      "CHFOOD14B7",
      "CHFOOD14B8",
      "CHFOOD14B9",
      "CHFOOD14B9TXT",
      "CHFOOD14C",
      "CHFOOD15A",
      "CHFOOD15B",
      "CHFOOD15C",
      "CHFOOD16A",
      "CHFOOD16B",
      "CHFOOD17A",
      "CHFOOD17B",
      "CHFOOD18A",
      "CHFOOD18B",
      "CHFOOD19A",
      "CHFOOD19B",
      "CHFOOD19C1",
      "CHFOOD19C2",
      "CHFOOD36A",
      "CHFOOD36B",
      "CHFOOD37A",
      "CHFOOD37B",
      "CHFOOD38A",
      "CHFOOD38B",
      "CHFOOD39A",
      "CHFOOD39B",
      "CHFOOD40A",
      "CHFOOD40B",
      "CHFOOD41A",
      "CHFOOD41B",
      "CHFOOD20A",
      "CHFOOD20B",
      "CHFOOD42A",
      "CHFOOD42B",
      "CHFOOD21A",
      "CHFOOD21B",
      "CHFOOD22A",
      "CHFOOD22B",
      "CHFOOD23A",
      "CHFOOD23B",
      "CHFOOD24A",
      "CHFOOD24B",
      "CHFOOD43A",
      "CHFOOD43B",
      "CHFOOD25A1",
      "CHFOOD25B",
      "CHFOOD25C1",
      "CHFOOD25C2",
      "CHFOOD25C3",
      "CHFOOD25C4A",
      "CHFOOD26A",
      "CHFOOD26B",
      "CHFOOD27A",
      "CHFOOD27B",
      "CHFOOD28A",
      "CHFOOD28B",
      "CHFOOD29A",
      "CHFOOD29B",
      "CHFOOD29C",
      "CHFOOD29D",
      "CHFOOD29E",
      "CHFOOD29F",
      "CHFOOD29G",
      "CHFOOD29H",
      "CHFOOD29I",
      "CHFOOD29J",
      "CHFOOD29K",
      "CHFOOD29L",
      "CHFOOD29M",
      "CHFOOD29N",
      "CHFOOD29O",
      "CHFOOD29P",
      "CHFOOD29PTXT",
      "CHFOOD30A",
      "CHFOOD30B",
      "CHFOOD30C1",
      "CHFOOD30C2",
      "CHFOOD30C3",
      "CHFOOD30C4",
      "CHFOOD44A",
      "CHFOOD44B",
      "CHFOOD45A",
      "CHFOOD45B",
      "CHFOOD46A",
      "CHFOOD46B",
      "CHFOOD47A",
      "CHFOOD47B",
      "CHFOOD48A",
      "CHFOOD48B",
      "CHFOOD49A",
      "CHFOOD49B",
      "CHFOOD50A",
      "CHFOOD50B",
      "CHFOOD51A",
      "CHFOOD51B",
      "CHFOOD31A",
      "CHFOOD31B",
      "CHFOOD32A",
      "CHFOOD32B",
      "CHFOOD33A",
      "CHFOOD33B",
      "CHFOOD34TXT",
      "CHFOOD35A",
      "CHFOOD35C",
      "XCHFOOD35D",
      "CHFOOD52A",
      "CHFOOD52B",
      "XCHFOOD52C") %in% colnames(m12)

unique(x)

m12_wur <- m12 [ , c("NEXT_NR", 
                   "CHALLERGY6",
                   "CHALLERGY6A",
                   "CHALLERGY6B",
                   "CHALLERGY6C",
                   "CHALLERGY6D",
                   "CHALLERGY6E",
                   "CHALLERGY6F",
                   "CHALLERGY6FTXT",
                   "CHFOOD8",
                   "CHFOOD8A",
                   "CHFOOD8B",
                   "CHFOOD8C",
                   "CHFOOD8CTXT",
                   "CHFOOD9A",
                   "CHFOOD9B",
                   "CHFOOD10A",
                   "CHFOOD10B",
                   "CHFOOD10C",
                   "CHFOOD10D20",
                   "CHFOOD10D21",
                   "CHFOOD10D22",
                   "CHFOOD10D23",
                   "CHFOOD10D24",
                   "CHFOOD10D25",
                   "CHFOOD10D26",
                   "CHFOOD10D27",
                   "CHFOOD10D28",
                   "CHFOOD10D7",
                   "CHFOOD10D29",
                   "CHFOOD10D30",
                   "CHFOOD10D9",
                   "CHFOOD10D31",
                   "CHFOOD10D32",
                   "CHFOOD10D33",
                   "CHFOOD10D34",
                   "CHFOOD10D35",
                   "CHFOOD10D13",
                   "CHFOOD10D36",
                   "CHFOOD10D37",
                   "CHFOOD10D38",
                   "CHFOOD10D39",
                   "CHFOOD10D17",
                   "CHFOOD10D40",
                   "CHFOOD10D19",
                   "CHFOOD10D19TXT",
                   "CHFOOD11A",
                   "CHFOOD11B",
                   "CHFOOD12A",
                   "CHFOOD12B",
                   "CHFOOD13A",
                   "CHFOOD13B",
                   "CHFOOD13C1",
                   "CHFOOD13C2",
                   "CHFOOD13C3",
                   "CHFOOD13C4",
                   "CHFOOD14A",
                   "CHFOOD14B1",
                   "CHFOOD14B2",
                   "CHFOOD14B3",
                   "CHFOOD14B4",
                   "CHFOOD14B5",
                   "CHFOOD14B6",
                   "CHFOOD14B7",
                   "CHFOOD14B8",
                   "CHFOOD14B9",
                   "CHFOOD14B9TXT",
                   "CHFOOD14C",
                   "CHFOOD15A",
                   "CHFOOD15B",
                   "CHFOOD15C",
                   "CHFOOD16A",
                   "CHFOOD16B",
                   "CHFOOD17A",
                   "CHFOOD17B",
                   "CHFOOD18A",
                   "CHFOOD18B",
                   "CHFOOD19A",
                   "CHFOOD19B",
                   "CHFOOD19C1",
                   "CHFOOD19C2",
                   "CHFOOD36A",
                   "CHFOOD36B",
                   "CHFOOD37A",
                   "CHFOOD37B",
                   "CHFOOD38A",
                   "CHFOOD38B",
                   "CHFOOD39A",
                   "CHFOOD39B",
                   "CHFOOD40A",
                   "CHFOOD40B",
                   "CHFOOD41A",
                   "CHFOOD41B",
                   "CHFOOD20A",
                   "CHFOOD20B",
                   "CHFOOD42A",
                   "CHFOOD42B",
                   "CHFOOD21A",
                   "CHFOOD21B",
                   "CHFOOD22A",
                   "CHFOOD22B",
                   "CHFOOD23A",
                   "CHFOOD23B",
                   "CHFOOD24A",
                   "CHFOOD24B",
                   "CHFOOD43A",
                   "CHFOOD43B",
                   "CHFOOD25A1",
                   "CHFOOD25B",
                   "CHFOOD25C1",
                   "CHFOOD25C2",
                   "CHFOOD25C3",
                   "CHFOOD25C4A",
                   "CHFOOD26A",
                   "CHFOOD26B",
                   "CHFOOD27A",
                   "CHFOOD27B",
                   "CHFOOD28A",
                   "CHFOOD28B",
                   "CHFOOD29A",
                   "CHFOOD29B",
                   "CHFOOD29C",
                   "CHFOOD29D",
                   "CHFOOD29E",
                   "CHFOOD29F",
                   "CHFOOD29G",
                   "CHFOOD29H",
                   "CHFOOD29I",
                   "CHFOOD29J",
                   "CHFOOD29K",
                   "CHFOOD29L",
                   "CHFOOD29M",
                   "CHFOOD29N",
                   "CHFOOD29O",
                   "CHFOOD29P",
                   "CHFOOD29PTXT",
                   "CHFOOD30A",
                   "CHFOOD30B",
                   "CHFOOD30C1",
                   "CHFOOD30C2",
                   "CHFOOD30C3",
                   "CHFOOD30C4",
                   "CHFOOD44A",
                   "CHFOOD44B",
                   "CHFOOD45A",
                   "CHFOOD45B",
                   "CHFOOD46A",
                   "CHFOOD46B",
                   "CHFOOD47A",
                   "CHFOOD47B",
                   "CHFOOD48A",
                   "CHFOOD48B",
                   "CHFOOD49A",
                   "CHFOOD49B",
                   "CHFOOD50A",
                   "CHFOOD50B",
                   "CHFOOD51A",
                   "CHFOOD51B",
                   "CHFOOD31A",
                   "CHFOOD31B",
                   "CHFOOD32A",
                   "CHFOOD32B",
                   "CHFOOD33A",
                   "CHFOOD33B",
                   "CHFOOD34TXT",
                   "CHFOOD35A",
                   "CHFOOD35C",
                   "XCHFOOD35D",
                   "CHFOOD52A",
                   "CHFOOD52B",
                   "XCHFOOD52C")] 

dim(m12_wur)
# 231 171


m12_wur <- m12_wur %>% rename("patrI_1_M12"="CHALLERGY6",
                              "patrI_2_M12"="CHALLERGY6A",
                              "patrI_3_M12"="CHALLERGY6B",
                              "patrI_4_M12"="CHALLERGY6C",
                              "patrI_5_M12"="CHALLERGY6D",
                              "patrI_6_M12"="CHALLERGY6E",
                              "patrI_7_M12"="CHALLERGY6F",
                              "patrI_7anders_M12"="CHALLERGY6FTXT",
                              "patrII_1_M12"="CHFOOD8",
                              "patrII_2_M12"="CHFOOD8A",
                              "patrII_3_M12"="CHFOOD8B",
                              "patrII_4_M12"="CHFOOD8C",
                              "patrII_4anders_M12"="CHFOOD8CTXT",
                              "v01a_M12"="CHFOOD9A",
                              "v01b_M12"="CHFOOD9B",
                              "v02a_M12"="CHFOOD10A",
                              "v02b_M12"="CHFOOD10B",
                              "v02c_M12"="CHFOOD10C",
                              "v02d1_M12"="CHFOOD10D20",
                              "v02d2_M12"="CHFOOD10D21",
                              "v02d3_M12"="CHFOOD10D22",
                              "v02d4_M12"="CHFOOD10D23",
                              "v02d5_M12"="CHFOOD10D24",
                              "v02d6_M12"="CHFOOD10D25",
                              "v02d7_M12"="CHFOOD10D26",
                              "v02d8_M12"="CHFOOD10D27",
                              "v02d9_M12"="CHFOOD10D28",
                              "v02d10_M12"="CHFOOD10D7",
                              "v02d11_M12"="CHFOOD10D29",
                              "v02d12_M12"="CHFOOD10D30",
                              "v02d13_M12"="CHFOOD10D9",
                              "v02d14_M12"="CHFOOD10D31",
                              "v02d15_M12"="CHFOOD10D32",
                              "v02d16_M12"="CHFOOD10D33",
                              "v02d17_M12"="CHFOOD10D34",
                              "v02d18_M12"="CHFOOD10D35",
                              "v02d19_M12"="CHFOOD10D13",
                              "v02d20_M12"="CHFOOD10D36",
                              "v02d21_M12"="CHFOOD10D37",
                              "v02d22_M12"="CHFOOD10D38",
                              "v02d23_M12"="CHFOOD10D39",
                              "v02d24_M12"="CHFOOD10D17",
                              "v02d25_M12"="CHFOOD10D40",
                              "v02d26_M12"="CHFOOD10D19",
                              "v02d26_anders_M12"="CHFOOD10D19TXT",
                              "v03a_M12"="CHFOOD11A",
                              "v03b_M12"="CHFOOD11B",
                              "v04a_M12"="CHFOOD12A",
                              "v04b_M12"="CHFOOD12B",
                              "v05a_M12"="CHFOOD13A",
                              "v05b_M12"="CHFOOD13B",
                              "v05c1_M12"="CHFOOD13C1",
                              "v05c2_M12"="CHFOOD13C2",
                              "v05c3_M12"="CHFOOD13C3",
                              "v05c4_M12"="CHFOOD13C4",
                              "v06a_M12"="CHFOOD14A",
                              "v06b1_M12"="CHFOOD14B1",
                              "v06b2_M12"="CHFOOD14B2",
                              "v06b3_M12"="CHFOOD14B3",
                              "v06b4_M12"="CHFOOD14B4",
                              "v06b5_M12"="CHFOOD14B5",
                              "v06b6_M12"="CHFOOD14B6",
                              "v06b7_M12"="CHFOOD14B7",
                              "v06b8_M12"="CHFOOD14B8",
                              "v06b9_M12"="CHFOOD14B9",
                              "v06b9_anders_M12"="CHFOOD14B9TXT",
                              "v06c_M12"="CHFOOD14C",
                              "v07a_M12"="CHFOOD15A",
                              "v07b_M12"="CHFOOD15B",
                              "v07c_M12"="CHFOOD15C",
                              "v08a_M12"="CHFOOD16A",
                              "v08b_M12"="CHFOOD16B",
                              "v09a_M12"="CHFOOD17A",
                              "v09b_M12"="CHFOOD17B",
                              "v10a_M12"="CHFOOD18A",
                              "v10b_M12"="CHFOOD18B",
                              "v11a_M12"="CHFOOD19A",
                              "v11b_M12"="CHFOOD19B",
                              "v11c1_M12"="CHFOOD19C1",
                              "v11c2_M12"="CHFOOD19C2",
                              "v12a_M12"="CHFOOD36A",
                              "v12b_M12"="CHFOOD36B",
                              "v13a_M12"="CHFOOD37A",
                              "v13b_M12"="CHFOOD37B",
                              "v14a_M12"="CHFOOD38A",
                              "v14b_M12"="CHFOOD38B",
                              "v15a_M12"="CHFOOD39A",
                              "v15b_M12"="CHFOOD39B",
                              "v16a_M12"="CHFOOD40A",
                              "v16b_M12"="CHFOOD40B",
                              "v17a_M12"="CHFOOD41A",
                              "v17b_M12"="CHFOOD41B",
                              "v18a_M12"="CHFOOD20A",
                              "v18b_M12"="CHFOOD20B",
                              "v19a_M12"="CHFOOD42A",
                              "v19b_M12"="CHFOOD42B",
                              "v20a_M12"="CHFOOD21A",
                              "v20b_M12"="CHFOOD21B",
                              "v21a_M12"="CHFOOD22A",
                              "v21b_M12"="CHFOOD22B",
                              "v22a_M12"="CHFOOD23A",
                              "v22b_M12"="CHFOOD23B",
                              "v23a_M12"="CHFOOD24A",
                              "v23b_M12"="CHFOOD24B",
                              "v24a_M12"="CHFOOD43A",
                              "v24b_M12"="CHFOOD43B",
                              "v25a_M12"="CHFOOD25A1",
                              "v25b_M12"="CHFOOD25B",
                              "v25c1_M12"="CHFOOD25C1",
                              "v25c2_M12"="CHFOOD25C2",
                              "v25c3_M12"="CHFOOD25C3",
                              "v25c4_M12"="CHFOOD25C4A",
                              "v26a_M12"="CHFOOD26A",
                              "v26b_M12"="CHFOOD26B",
                              "v27a_M12"="CHFOOD27A",
                              "v27b_M12"="CHFOOD27B",
                              "v28a_M12"="CHFOOD28A",
                              "v28b_M12"="CHFOOD28B",
                              "v29a1_M12"="CHFOOD29A",
                              "v29a2_M12"="CHFOOD29B",
                              "v29a3_M12"="CHFOOD29C",
                              "v29a4_M12"="CHFOOD29D",
                              "v29a5_M12"="CHFOOD29E",
                              "v29a6_M12"="CHFOOD29F",
                              "v29a7_M12"="CHFOOD29G",
                              "v29a8_M12"="CHFOOD29H",
                              "v29a9_M12"="CHFOOD29I",
                              "v29a10_M12"="CHFOOD29J",
                              "v29a11_M12"="CHFOOD29K",
                              "v29a12_M12"="CHFOOD29L",
                              "v29a13_M12"="CHFOOD29M",
                              "v29a14_M12"="CHFOOD29N",
                              "v29a15_M12"="CHFOOD29O",
                              "v29a16_M12"="CHFOOD29P",
                              "v29a16_anders_M12"="CHFOOD29PTXT",
                              "v30a_M12"="CHFOOD30A",
                              "v30b_M12"="CHFOOD30B",
                              "v30c1_M12"="CHFOOD30C1",
                              "v30c2_M12"="CHFOOD30C2",
                              "v30c3_M12"="CHFOOD30C3",
                              "v30c4_M12"="CHFOOD30C4",
                              "v31a_M12"="CHFOOD44A",
                              "v31b_M12"="CHFOOD44B",
                              "v32a_M12"="CHFOOD45A",
                              "v32b_M12"="CHFOOD45B",
                              "v33a_M12"="CHFOOD46A",
                              "v33b_M12"="CHFOOD46B",
                              "v34a_M12"="CHFOOD47A",
                              "v34b_M12"="CHFOOD47B",
                              "v35a_M12"="CHFOOD48A",
                              "v35b_M12"="CHFOOD48B",
                              "v36a_M12"="CHFOOD49A",
                              "v36b_M12"="CHFOOD49B",
                              "v37a_M12"="CHFOOD50A",
                              "v37b_M12"="CHFOOD50B",
                              "v38a_M12"="CHFOOD51A",
                              "v38b_M12"="CHFOOD51B",
                              "v39a_M12"="CHFOOD31A",
                              "v39b_M12"="CHFOOD31B",
                              "v40a_M12"="CHFOOD32A",
                              "v40b_M12"="CHFOOD32B",
                              "v41a_M12"="CHFOOD33A",
                              "v41b_M12"="CHFOOD33B",
                              "v42_M12"="CHFOOD34TXT",
                              "v43a_M12"="CHFOOD35A",
                              "v43b_M12"="CHFOOD35C",
                              "v43c_M12"="XCHFOOD35D",
                              "v44a_M12"="CHFOOD52A",
                              "v44b_M12"="CHFOOD52B",
                              "v44c_M12"="XCHFOOD52C")
str(m12_wur)

write.csv(m12_wur, "/groups/umcg-llnext/tmp01/umcg-snbrushett/processed/FFQs_recoded_WUR/FFQs_by_time_point/20.08.2021_M12_WUR.csv")


   ## =============== 4. CLEAN AND MERGE DATASETS   ================ ##

m9 <-  read.csv("20.08.2021_M9_WUR.csv", header=T, as.is=T, sep=",", row.names = 1)
m12 <-  read.csv("20.08.2021_M12_WUR.csv", header=T, as.is=T, sep=",", row.names = 1)

dim(m9)
dim(m12)

#ADD LEADING ZEROS BACK TO NEXT_NR 
m9$NEXT_NR = formatC(m9$NEXT_NR, width = 6, format = "d", flag = "0")
m12$NEXT_NR = formatC(m12$NEXT_NR, width = 6, format = "d", flag = "0")

WUR_cdbk4 <- full_join(m9, m12, by = "NEXT_NR")
dim(WUR_cdbk4)
#360 341

write.csv(WUR_cdbk4, "/groups/umcg-llnext/tmp01/umcg-snbrushett/processed/FFQs_recoded_WUR/files_for_WUR/20.08.2021_WUR_9-12mnd.csv")
